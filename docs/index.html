<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Synthetic Control Using Lasso (SCUL) • scul</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Synthetic Control Using Lasso (SCUL)">
<meta property="og:description" content='Synthetic control methods are a popular strategy for estimating counterfactual outcomes using weighted averages of untreated groups. We use lasso regressions to construct synthetic control weights, allowing for a high-dimensional donor pool and for negatively correlated donors to contribute to the synthetic prediction; neither of which is possible using traditional methods. This package provides code to run the synthetic control using lasso (SCUL) estimator that is outlined in Hollingsworth and Wing (2020) "Tactics for design and inference in synthetic control studies: An applied example using high-dimensional data." https://doi.org/10.31235/osf.io/fc9xt'>
<meta property="og:image" content="https://hollina.github.io/scul/logo.svg">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@ajhollingsworth">
<meta name="twitter:site" content="@ajhollingsworth">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">scul</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/scul-tutorial.html">Tutorial</a>
</li>
<li>
  <a href="reference/index.html">Functions</a>
</li>
<li>
  <a href="https://doi.org/10.31235/osf.io/fc9xt">Paper</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hollina/scul">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="synthetic-control-using-lasso-scul-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#synthetic-control-using-lasso-scul-" class="anchor" aria-hidden="true"></a>Synthetic Control Using Lasso (scul) <img src="reference/figures/logo_large.png" align="right" alt="" width="120">
</h1></div>
<!-- badges: start -->

<p>This repository contains the R package <code>scul</code> that is used in Hollingsworth and Wing (2020) <em>“Tactics for design and inference in synthetic control studies: An applied example using high-dimensional data.”</em> <a href="https://doi.org/10.31235/osf.io/fc9xt" class="external-link uri">https://doi.org/10.31235/osf.io/fc9xt</a></p>
<div class="figure">
<img src="reference/figures/ReadMeFigure.png" alt=""><p class="caption">figure1</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor" aria-hidden="true"></a>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install development version from GitHub (CRAN coming soon) using these two lines of code</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"devtools"</span>)) <span class="fu">install.packages</span>(<span class="st">"devtools"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"hollina/scul"</span>)<span class="st">`</span></span></code></pre></div>
</div>
<div id="tutorialmore-details" class="section level2">
<h2 class="hasAnchor">
<a href="#tutorialmore-details" class="anchor" aria-hidden="true"></a>Tutorial/More details</h2>
<p>An in-depth tutorial of the package and overview of every function in the package is available here, <a href="https://hollina.github.io/scul/articles/scul-tutorial.html" class="uri">https://hollina.github.io/scul/articles/scul-tutorial.html</a>. The tutorial uses publicly available data and discusses many features of the SCUL procedure. The tutorial also provides a simple comparison of the SCUL method to the traditional synthetic control method.</p>
<p>More details on SCUL can be found in our <a href="https://doi.org/10.31235/osf.io/fc9xt" class="external-link">working paper</a>. The paper, joint with Coady Wing, desribes identification assumptions and recommendations for key—and normally ad hoc—decisions that arise in most synthetic control studies. The paper then describes the SCUL method and uses the procedure to estimate how recreational marijuana legalization affects sales of alcohol and over-the-counter painkillers, finding reductions in alcohol sales.</p>
</div>
<div id="what-is-a-synthetic-control" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-a-synthetic-control" class="anchor" aria-hidden="true"></a>What is a synthetic control?</h2>
<p>The synthetic control methodology is a strategy for estimating causal treatment effects for idiosyncratic historical events. In the typical application developed by Abadie, Diamond, and Hainmueller (2010), researchers observe time series outcomes for both a treated unit and a number of untreated units. A weighted average of the untreated series is used as a counterfactual estimate of the treated series, which is referred to as a synthetic comparison group. Weights are chosen to minimize discrepancies between the synthetic comparison group and the treated unit in the pre-treatment time period. Treatment effect estimates are usually the difference between observed outcomes and the synthetic counterfactual. Statistical inference is normally organized around a placebo analysis; in which, pseudo-treatment effects are estimated for many untreated placebo units, and the distribution of pseudo-estimates represents the null distribution of no treatment effect.</p>
<p>A useful way to think about synthetic controls is as a procedure that attempts to <em>match</em> donor series to target series based on the unobserved factors that determine the data generating process. When framed in this manner identification assumptions and strategies for model selection/inference become more salient.</p>
<p>Recent methodological work has proposed a number of innovative strategies for estimating synthetic control weights (Arkhangelsky et al. 2018; Doudchenko and Imbens 2017; Powell 2019). In a similar vein, we construct donor weights using a method we call <strong>Synthetic Control Using Lasso (SCUL)</strong>.</p>
</div>
<div id="what-is-scul" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-scul" class="anchor" aria-hidden="true"></a>What is SCUL?</h2>
<p>This method is a flexible, data-driven way to construct synthetic control groups. It relies on lasso regressions, which are popular in the machine-learning literature, and favor weights that predict well out of sample.</p>
<p>Our working paper highlights <strong>identification assumptions</strong> and <strong>recommendations</strong> that are relevant for any synthetic control study.</p>
<p>In general, our approach allows for:</p>
<ul>
<li>a high-dimensional donor pool that may be larger than the number of time periods</li>
<li>a simple way of ensuring that the same model selection procedure are used for target and placebo series</li>
<li>a wide variety of variable types to serve as candidate donors</li>
<li>extrapolation from the donor pool</li>
<li>counter-cyclical weights</li>
</ul>
<p>We consider the combination of this statistical approach and following these recommendations as the SCUL procedure</p>
</div>
<div id="what-are-the-contributions-of-scul" class="section level2">
<h2 class="hasAnchor">
<a href="#what-are-the-contributions-of-scul" class="anchor" aria-hidden="true"></a>What are the contributions of SCUL?</h2>
<div id="1-clarifies-idenficiation-assumptions-for-synthetic-control-methods" class="section level3">
<h3 class="hasAnchor">
<a href="#1-clarifies-idenficiation-assumptions-for-synthetic-control-methods" class="anchor" aria-hidden="true"></a>1. Clarifies idenficiation assumptions for synthetic control methods</h3>
<p>We outline two simple identification assumptions required for a synthetic control design to identify causal treatment parameters:</p>
<ol style="list-style-type: decimal">
<li>conditional independence of treatment exposure and potential outcomes after matching on an underlying factor structure</li>
<li>no dormant factors during the pre-treatment period.</li>
</ol>
<p>While neither of these assumptions is directly testable, our working paper offers perspectives and strategies that may help in interpreting the validity of such assumptions in applied work.</p>
</div>
<div id="2-provides-recommendations-for-normally-ad-hoc-choices" class="section level3">
<h3 class="hasAnchor">
<a href="#2-provides-recommendations-for-normally-ad-hoc-choices" class="anchor" aria-hidden="true"></a>2. Provides recommendations for normally ad hoc choices</h3>
<p>Our recommendations for decisions that commonly appear in synthetic control studies include:</p>
<ol style="list-style-type: decimal">
<li>using the same model selection procedure for both target and placebo products</li>
<li>using a unit-free measure to evaluate model fit</li>
<li>discarding both potential target series and placebo series (used in inference) that do poorly on a pre-specified threshold of model fit</li>
<li>incorporating a rolling-origin cross-validation procedure to determine optimal weights</li>
<li>reporting synthetic control weights as the average contribution to the synthetic prediction rather than as a numeric coefficient</li>
<li>using a unit-free measure of the treatment effect estimate to compare estimated treatment effects to the placebo distribution for inference</li>
<li>reporting the minimum treatment effect size for a given significance level that the placebo distribution used for inference would consider statistically different than zero</li>
</ol>
<p>We implement versions of the recommendations in our <a href="https://hollina.github.io/scul/articles/scul-tutorial.html">tutorial</a> and outline each in more detail in our working paper.</p>
</div>
<div id="3-uses-machine-learning-approach-that-allows-for-high-dimensional-donor-pool-and-automates-model-selection" class="section level3">
<h3 class="hasAnchor">
<a href="#3-uses-machine-learning-approach-that-allows-for-high-dimensional-donor-pool-and-automates-model-selection" class="anchor" aria-hidden="true"></a>3. Uses machine-learning approach that allows for high-dimensional donor pool and automates model selection</h3>
<p>Lasso regressions penalize specifications with numerious variables and large coeficients. This drives the value of many coefficients to zero and allows for the inclusion of very large donor pools. A benefit of this is that—so long as a donor is theoreticlally valid— a researcher will not need to decide whether to include one donor over another. A cost of this is the concern that the procedure could overfit the data. SCUL weights are created using cross-validated lasso regressions that ensure the weights do not “overfit” the data and that favor out-of-sample prediction.</p>
<p>By automating model selection and allowing for a large number of donors, we reduce “researcher degrees of freedom.” It is easy to imagine that the best synthetic prediction could be created for each target series, but less time would be spent perfecting the model for each placebo series. If the automated model selection results in better fit for placebo series, we also improve the statistical power. This occurs if better fit in the pre-treatment period results in less deterioration (i.e., better fit) in the post-period. This improves statistical power because statistical inference in done by comparing deviations of the treated series to the distribution of placebo deviations. Therefore reducing the spread of the placebo null-distribution allows for smaller deviations of the treated unit to be considered statistically rare.</p>
</div>
<div id="4-includes-a-wide-variety-of-donor-types" class="section level3">
<h3 class="hasAnchor">
<a href="#4-includes-a-wide-variety-of-donor-types" class="anchor" aria-hidden="true"></a>4. Includes a wide variety of donor types</h3>
<p>We frame synthetic controls as a way of matching on unobserved underlying factors that form the data generating process. When viewed in this context, using donor units from a wide range of variable types makes sense because different variable types may help pin down different underlying factors/features of the data generating process for the treated unit. As such <strong>we use a wide range of donor variables</strong> to construct our synthetic control groups, not just the same variable type as the target variable as is common practice.</p>
</div>
<div id="5-allows-for-extrapolation-and-negative-weights" class="section level3">
<h3 class="hasAnchor">
<a href="#5-allows-for-extrapolation-and-negative-weights" class="anchor" aria-hidden="true"></a>5. Allows for extrapolation and negative weights</h3>
<p>The traditional synthetic control method restricts weights to be non-negative and to sum to one. These restrictions force the synthetic control group to remain within the support (i.e., convex hull) of the donor pool, preventing extrapolation. This can certainly be a desirable property. However there are some situations where these restrictions that prevent extrapolation can inhibit a synthetic control group from finding a perfect donor series.</p>
<ul>
<li>Case 1: When the target series is outside the the support of the donor pool (i.e. you need extrapolation to match the target series</li>
<li>Case 2: When negatively correlated donors can help identify underlying data generating process (e.g., two financial assets, or a price and consumption series)</li>
</ul>
<div class="figure">
<img src="reference/figures/time_series_convex_hull.png" alt=""><p class="caption">figure2</p>
</div>
</div>
</div>
<div id="software-used" class="section level2">
<h2 class="hasAnchor">
<a href="#software-used" class="anchor" aria-hidden="true"></a>Software Used:</h2>
<p>The package is made for R. and was developed on a Unix machine using R 3.6.1. See session info in the vignette for exact version of every package used. Documentation was made using <code>roxygen2</code>, <code>pkgdown</code>, and <code>RStudio</code>.</p>
</div>
<div id="to-do" class="section level2">
<h2 class="hasAnchor">
<a href="#to-do" class="anchor" aria-hidden="true"></a>To Do:</h2>
<ol style="list-style-type: decimal">
<li>Add examples to each function</li>
<li>Proof read documentation</li>
<li>Release package via CRAN</li>
<li>Distribute video FAQs</li>
</ol>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor" aria-hidden="true"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Abadie2010">
<p>Abadie, Alberto, Alexis Diamond, and Jens Hainmueller. 2010. “Synthetic Control Methods for Comparative Case Studies: Estimating the Effect of California’s Tobacco Control Program.” <em>Journal of the American Statistical Association</em> 105 (490): 493–505. <a href="https://doi.org/10.1198/jasa.2009.ap08746" class="external-link uri">https://doi.org/10.1198/jasa.2009.ap08746</a>.</p>
</div>
<div id="ref-Arkhangelsky2018">
<p>Arkhangelsky, Dmitry, Susan Athey, David A. Hirshberg, Guido W. Imbens, and Stefan Wager. 2018. “Synthetic Difference in Differences.” <a href="http://arxiv.org/abs/1812.09970" class="external-link uri">http://arxiv.org/abs/1812.09970</a>.</p>
</div>
<div id="ref-Doudchenko2017">
<p>Doudchenko, Nikolay, and Guido W. Imbens. 2017. “Balancing, Regression, Difference-In-Differences and Synthetic Control Methods: A Synthesis.” <a href="http://arxiv.org/abs/1610.07748" class="external-link uri">http://arxiv.org/abs/1610.07748</a>.</p>
</div>
<div id="ref-Powell2019">
<p>Powell, David. 2019. “Imperfect Synthetic Controls,” no. May 2017: 1–38. <a href="https://sites.google.com/site/davidmatthewpowell/imperfect-synthetic-controls" class="external-link uri">https://sites.google.com/site/davidmatthewpowell/imperfect-synthetic-controls</a>.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/hollina/scul/">https://​github.com/​hollina/​scul/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/hollina/scul/issues/">https://​github.com/​hollina/​scul/​issues/​</a>
</li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://alexjhollingsworth.com">Alex Hollingsworth</a> <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.com/hollina/scul" class="external-link"><img src="https://travis-ci.com/hollina/scul.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://opensource.org/licenses/MIT" class="external-link"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://alexjhollingsworth.com" class="external-link">Alex Hollingsworth</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
