<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SCUL Tutorial • scul</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="SCUL Tutorial">
<meta property="og:description" content="scul">
<meta property="og:image" content="https://hollina.github.io/scul/logo.svg">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@ajhollingsworth">
<meta name="twitter:site" content="@ajhollingsworth">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scul</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/scul-tutorial.html">Tutorial</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="https://doi.org/10.31235/osf.io/fc9xt" class="external-link">Paper</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hollina/scul" class="external-link">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="scul-tutorial_files/header-attrs-2.8/header-attrs.js"></script><script src="scul-tutorial_files/kePrint-0.0.1/kePrint.js"></script><link href="scul-tutorial_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>SCUL Tutorial</h1>
            <h3 data-toc-skip class="subtitle">Overview of R package, extended example using publicly available data, and brief comparison to traditional method</h3>
                        <h4 data-toc-skip class="author">Alex Hollingsworth</h4>
            
            <h4 data-toc-skip class="date">2021-05-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hollina/scul/blob/master/vignettes/scul-tutorial.Rmd" class="external-link"><code>vignettes/scul-tutorial.Rmd</code></a></small>
      <div class="hidden name"><code>scul-tutorial.Rmd</code></div>

    </div>

    
    
<!-- 
  Code to Justify Text
    <style>
    body {
    text-align: justify}
    </style>
-->
<hr>
<div id="example-data" class="section level1">
<h1 class="hasAnchor">
<a href="#example-data" class="anchor" aria-hidden="true"></a>Example data</h1>
<p>This tutorial uses publicly available data that is similar to the data used in <span class="citation">Abadie, Diamond, and Hainmueller (2010)</span>. The empirical goal of <span class="citation">Abadie, Diamond, and Hainmueller (2010)</span> was to estimate the effects of a California tobacco control policy implemented in 1988.</p>
<p>When in long form, the data are at the state-year level and range from 1970 to 1997 (28 years). For each state and year there are data on cigarette sales per capita (<code>cigsale</code>) and the retail price of cigarettes (<code>retprice</code>). To be used in the SCUL procedure, the data must be in wide format, where each row is a time-period (e.g., year) and each column is a unit-specific variable. In our data, for each variable the unit is identified by the end of each column name (e.g., variables from the state of California are indicated by <code>_6</code>, which is the FIPS code for California.)</p>
<p>The dataset should be sorted by whatever variable you use to index time with the earliest date being first and the most recent date being last.</p>
<p>The <code>cigarette_sales</code> dataset is stored in the <code>data</code> subdirectory of this package. It should be automatically loaded when the <code>scul</code> package is loaded.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">cigarette_sales</span><span class="op">)</span>
<span class="co">#&gt; [1] 28 79</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cigarette_sales</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;   year cigsale_6 cigsale_1 retprice_1 cigsale_5 retprice_5</span>
<span class="co">#&gt; 1 1970     123.0      89.8       39.6     100.3       36.7</span>
<span class="co">#&gt; 2 1971     121.0      95.4       42.7     104.1       38.8</span>
<span class="co">#&gt; 3 1972     123.5     101.1       42.3     103.9       44.1</span>
<span class="co">#&gt; 4 1973     124.4     102.9       42.1     108.0       45.1</span>
<span class="co">#&gt; 5 1974     126.7     108.2       43.1     109.7       45.5</span>
<span class="co">#&gt; 6 1975     127.1     111.7       46.6     114.8       48.6</span></code></pre></div>
<p>We will break this dataset into two: one containing data on the target product and another containing all other data that will be used to as the donor pool for our synthetic counterfactual. In each dataset we will leave the first column, which indexes time. We will not include the retail price in California as a potential donor variable as this is endogenous.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">AllYData</span> <span class="op">&lt;-</span> <span class="va">cigarette_sales</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"cigsale_6"</span><span class="op">)</span><span class="op">)</span>
<span class="va">AllXData</span> <span class="op">&lt;-</span> <span class="va">cigarette_sales</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"cigsale_6"</span>, <span class="st">"retprice_6"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="pre-processingcleaning-data" class="section level2">
<h2 class="hasAnchor">
<a href="#pre-processingcleaning-data" class="anchor" aria-hidden="true"></a>Pre-processing/cleaning data</h2>
<p>Before we begin our analysis, let’s make sure the data are in the right format and trim any problematic variables.</p>
<div id="clean-data-with-preprocess" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-data-with-preprocess" class="anchor" aria-hidden="true"></a>Clean data with <code>Preprocess()</code>
</h3>
<p>The <code><a href="../reference/Preprocess.html">Preprocess()</a></code> function takes a matrix or a data-frame and ensures that each column</p>
<ul>
<li>is numeric</li>
<li>has all non-missing values</li>
<li>and is not constant</li>
</ul>
<p>It drops any column that violate these conditions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">processed.AllYData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Preprocess.html">Preprocess</a></span><span class="op">(</span><span class="va">AllYData</span><span class="op">)</span></code></pre></div>
</div>
<div id="use-preprocesssubset-to-ensure-that-all-subsets-have-variation" class="section level3">
<h3 class="hasAnchor">
<a href="#use-preprocesssubset-to-ensure-that-all-subsets-have-variation" class="anchor" aria-hidden="true"></a>Use <code>PreprocessSubset()</code> to ensure that all subsets have variation</h3>
<p>To avoid over-fitting, we will use a cross-validation approach that evaluate models on many subsets of the data. As such we need to ensure that the subsets of the variables used in the analysis have variation. The <code><a href="../reference/PreprocessSubset.html">PreprocessSubset()</a></code> is the same as the <code><a href="../reference/Preprocess.html">Preprocess()</a></code> function, except that it iteratively performs the same procedure on every subset that is used in the cross-validation.</p>
<p>To determine subsets used in the cross-validation process, it is necessary to input:</p>
<ul>
<li><p>First row for the first date of treatment <code>TreatmentBeginsAt</code> (we do this as row number to allow time to be input in a flexible manner)</p></li>
<li>
<p><code>NumberInitialTimePeriods</code>: The number of initial time periods wanted in the training data for the first cross-validation run.</p>
<ul>
<li>Ideally this number would be the same as the post-treatment length, but may need to be shorter if there are not enough pre-treatment time periods. For the example in our working paper, we use a very long pre-period. However the example in this vignette using a “short” dataset, so we use a smaller number here.</li>
</ul>
</li>
</ul>
<p>Assuming that treatment occurs at a discrete time and does not “turn-off,” both the pre-treatment length and post-treatment length are automatically calculated - The length of the post-treat</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TreatmentBeginsAt</span> <span class="op">&lt;-</span> <span class="fl">19</span> <span class="co"># Here the 18th row is 1988</span>
<span class="va">PostPeriodLength</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">processed.AllYData</span><span class="op">)</span> <span class="op">-</span> <span class="va">TreatmentBeginsAt</span> <span class="op">+</span> <span class="fl">1</span>
<span class="va">PrePeriodLength</span> <span class="op">&lt;-</span> <span class="va">TreatmentBeginsAt</span><span class="op">-</span><span class="fl">1</span>
<span class="va">NumberInitialTimePeriods</span> <span class="op">&lt;-</span> <span class="fl">5</span>
<span class="va">processed.AllYData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PreprocessSubset.html">PreprocessSubset</a></span><span class="op">(</span><span class="va">processed.AllYData</span>,
                                       <span class="va">TreatmentBeginsAt</span> ,
                                       <span class="va">NumberInitialTimePeriods</span>,
                                       <span class="va">PostPeriodLength</span>,
                                       <span class="va">PrePeriodLength</span><span class="op">)</span></code></pre></div>
</div>
<div id="use-organizedataandsetup-to-clean-donor-and-placebo-pool-data" class="section level3">
<h3 class="hasAnchor">
<a href="#use-organizedataandsetup-to-clean-donor-and-placebo-pool-data" class="anchor" aria-hidden="true"></a>Use <code>OrganizeDataAndSetup()</code> to clean donor and placebo pool data</h3>
<p><code><a href="../reference/OrganizeDataAndSetup.html">OrganizeDataAndSetup()</a></code> creates a list of items called that is called by the later SCUL procedures. We call this list <code>SCUL.input</code>. This function also cleans the donor and placebo pools in using the functions outlined above <code><a href="../reference/PreprocessSubset.html">PreprocessSubset()</a></code> and <code><a href="../reference/Preprocess.html">Preprocess()</a></code>.</p>
<p>In this function you need to specify:</p>
<ul>
<li>
<code>time</code>: a column vector for time</li>
<li>
<code>y</code>: a column vector for the target variable of interest</li>
<li>
<code>x.DonorPool</code>: the variables that will be used to construct your synthetic control group</li>
<li>
<code>CohensDThreshold</code>: a unit-free threshold for what is considered a satisfactory model fit (outlined in more detail below and in our paper)</li>
<li>
<code>x.PlaceboPool</code>: the variables that will be used to conduct statistical inference. Need not be the same as the donor pool. See below more details on the process used for statistical inference.</li>
<li>
<code>OutputFilePath</code>: a directory where output will be saved</li>
<li>
<code>NumberInitialTimePeriods</code>: The number of initial time periods wanted in the training data for the first cross-validation run.</li>
<li>
<code>TrainingPostPeriodLength</code>: The number of time periods wanted in the test data for all cross-validation runs. Ideally this would be the same as the post-treatment length since this is the length of time you are asking your prediction to preform an an out-of-sample prediction over. However for shorter panels this may not be feasible.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SCUL.input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/OrganizeDataAndSetup.html">OrganizeDataAndSetup</a></span> <span class="op">(</span>
    time <span class="op">=</span>  <span class="va">AllYData</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">year</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="va">AllYData</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">cigsale_6</span><span class="op">)</span>,
    TreatmentBeginsAt <span class="op">=</span> <span class="va">TreatmentBeginsAt</span>,
    x.DonorPool <span class="op">=</span> <span class="va">AllXData</span>,
    CohensDThreshold <span class="op">=</span> <span class="fl">0.25</span>,
    NumberInitialTimePeriods <span class="op">=</span> <span class="va">NumberInitialTimePeriods</span>,
    TrainingPostPeriodLength <span class="op">=</span> <span class="fl">7</span>,
    x.PlaceboPool <span class="op">=</span> <span class="va">AllXData</span>,
    OutputFilePath<span class="op">=</span><span class="st">"vignette_output/"</span>
<span class="op">)</span></code></pre></div>
<p>Note: Using <code>AllYData %&gt;% select(year)</code> keeps the result as a <code>data.frame</code> (<code>typeof(AllYData %&gt;% select(year))</code> returns list), while using <code>AllYData[ ,1]</code> returns a reduced dimension item (<code>typeof(AllYData[ ,1])</code> returns integer). Having integer can mess with the internal functions being used in <code><a href="../reference/Preprocess.html">Preprocess()</a></code> that check for missing values. It is on my to do list to fix these functions to be more flexible. But for now best to ensure that the objects entering <code>SCUL.input()</code> as <code>time</code>, <code>y</code>, <code>x.DonorPool</code>, and <code>x.PlaceboPool</code> are <code>data.frames</code>.</p>
</div>
</div>
<div id="examine-plot-raw-data-using-graphtargetdata" class="section level2">
<h2 class="hasAnchor">
<a href="#examine-plot-raw-data-using-graphtargetdata" class="anchor" aria-hidden="true"></a>Examine plot raw data using <code>GraphTargetData()</code>
</h2>
<p><code><a href="../reference/GraphTargetData.html">GraphTargetData()</a></code> will graph any variable against time placing a dashed vertical line in the period before treatment begins. The default is to graph the target variable. A png file is saved in the <code>OutputFilePath</code> designated in the <code><a href="../reference/OrganizeDataAndSetup.html">OrganizeDataAndSetup()</a></code> function.</p>
<p>This isn’t the most aesthetically appealing figure since it is automatically generated. However it serves as a nice check that your data are being input correctly and that your treatment time is where it should be. Here we can see that California cigarette sales have been declining across time and that the pre and post treatment times are delineated at 1988.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="fu"><a href="../reference/GraphTargetData.html">GraphTargetData</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="scul-tutorial_files/figure-html/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="what-is-a-synthetic-control-group-in-math" class="section level1">
<h1 class="hasAnchor">
<a href="#what-is-a-synthetic-control-group-in-math" class="anchor" aria-hidden="true"></a>What is a synthetic control group? (in math)</h1>
<p>Use <span class="math inline">\(s=0 \ldots S\)</span> to index the units of analysis. For this example the units are state-specific variable, such as cigarette sales per person in California (<code>cigsale_6</code>) or the retail sales price of cigarettes in Alabama (<code>retprice_1</code>). In other settings, the units might be the same outcome or product across geographical territories (e.g., limited to cigarette sales per capita in each state). In general, each <span class="math inline">\(s \in S\)</span> is either a donor unit or treated unit. For simplicity, suppose there is a single treated unit, denoted by <span class="math inline">\(s=0\)</span>, and a number of untreated units, each denoted by an <span class="math inline">\(s&gt;0\)</span>. Let <span class="math inline">\(t=1\ldots T\)</span> index time periods, which are weeks in our application.<br>
Next, assume that treatment exposure occurs in period <span class="math inline">\(T_0 + 1\)</span>. Finally, set <span class="math inline">\(D_{st}=1[t&gt;T_0]\times 1[s=0]\)</span> to be a binary variable equal to <span class="math inline">\(1\)</span> if unit <span class="math inline">\(s\)</span> is exposed to treatment in period <span class="math inline">\(t\)</span>.</p>
<p>Let <span class="math inline">\(y(0)_{st}\)</span> and <span class="math inline">\(y(1)_{st}\)</span> represent potential outcomes that record the outcome of unit <span class="math inline">\(s\)</span> in period <span class="math inline">\(t\)</span> under the control and treatment conditions. In our application, <span class="math inline">\(y(0)_{st}\)</span> is the quantity sold in product-state <span class="math inline">\(s\)</span> during period <span class="math inline">\(t\)</span> in the absence of a recreational marijuana law, and <span class="math inline">\(y(1)_{st}\)</span> is the quantity sold in the same product-state under the recreational marijuana law. The difference between the two is <span class="math inline">\(\beta_{st}=y(1)_{st}-y(0)_{st}\)</span>, which is the causal effect of treatment on unit <span class="math inline">\(s\)</span> at time <span class="math inline">\(t\)</span>. The realized outcome is <span class="math inline">\(y_{st}=y(0)_{st}+D_{st} \beta_{st}\)</span>.<br>
However, this introduces a natural identification problem because untreated outcomes are not observable for the treated unit following exposure to treatment. That is, after period <span class="math inline">\(T_0\)</span>, we are only able to observe values of <span class="math inline">\(y(1)_{0t}\)</span> for the treated unit.</p>
<p>The basic goal of the synthetic control strategy is to estimate values of <span class="math inline">\(y(0)_{0t}\)</span> in the post-treatment time periods. With those counterfactual estimates in hand, it is possible to estimate <span class="math inline">\(\beta_{st}\)</span> for the post-treatment periods <span class="math inline">\(t&gt;T_0\)</span>. Often the focus will be on multi-period average treatment effects rather period-specific estimates. For example, the average treatment effect on the treated unit (ATT) over the entire post-treatment period is <span class="math inline">\(ATT(T_0+1,T)=\frac{1}{(T-T_0-1)} \sum_{t=T_0+1}^T\beta_{0t}\)</span>.</p>
<p>A synthetic control is a weighted average of outcomes from a collection of candidate untreated control units. Suppose that <span class="math inline">\(x_t=(y_{1t},\ldots, y_{St})\)</span> is the <span class="math inline">\(1\times S\)</span> vector of the outcomes that prevailed in each of the candidate comparison units at time <span class="math inline">\(t\)</span>. Let <span class="math inline">\(\omega=(\pi_{1},\ldots,\pi_{S} )^T\)</span> be a <span class="math inline">\(S \times 1\)</span> vector of weights. A synthetic control group for the outcome of the treated unit is:</p>
<p><span class="math display">\[\begin{align}\label{eq:generic_synth_control}
y_{t}^* &amp;=   \sum_{s=1}^S y_{st}  \pi_{s} \nonumber\\
y_{t}^* &amp; =  x_t \omega
\end{align}\]</span></p>
</div>
<div id="synthetic-control-using-lasso-scul" class="section level1">
<h1 class="hasAnchor">
<a href="#synthetic-control-using-lasso-scul" class="anchor" aria-hidden="true"></a>Synthetic Control Using Lasso (SCUL)</h1>
<p>One way that synthetic control methods can differ from one another is how they determine <span class="math inline">\(\omega\)</span>. One potential method for choosing weights is a simple regression framework. For example, we could choose synthetic control weights by implementing an ordinary least squares regression on only pre-treatment data, choosing weights that minimize the sum of squared differences between the pre-treatment treated time series and the synthetic control group time series:</p>
<p><span class="math display">\[\begin{align}
\widehat{\omega}_{OLS} = arg\ min_{\omega}
\left(\sum_{t=1}^{T_0}(y_{0t}-x_t \omega)^2 \right)
\end{align}\]</span></p>
<p>Here, the weights are simply the coefficients that arise from a regression of outcomes for the treated unit on the outcomes from each of the comparison units using only the <span class="math inline">\(t=1...T_{0}\)</span> observations from the pre-treatment period. With the coefficients in hand, the synthetic control group is the predicted value from the regression for each period. In post-treatment time periods, the predicted values represent estimates of the counterfactual outcome based on the pre-treatment cross-sectional partial correlations between treated unit outcomes and each donor pool outcome. If the policy does induce a treatment effect on the outcomes, then the connection between treated outcomes and donor unit outcomes should change in the post-treatment period. That pattern will be measurable as an emerging difference between observed outcomes in the treated unit and the synthetic control series.</p>
<p>Although it is familiar and intuitive, the OLS method may not be ideal for choosing synthetic control weights. It may overfit the pre-treatment outcome data by emphasizing idiosyncratic correlations that are not a part of the true data-generating process.<br>
In that case, the synthetic control may have poor out-of-sample predictive performance. Another limitation is that the OLS estimator does not provide a unique set of weights in cases where there are more comparison units than pre-treatment observations (i.e., when <span class="math inline">\(T_0\leq S\)</span>).</p>
<p>An alternative approach is to choose synthetic control weights using a penalized regression method, such as the lasso. A lasso regression chooses synthetic control weights to solve:</p>
<p><span class="math display">\[\begin{align}
 \widehat{\omega}_{lasso} = arg \ min_{\omega } \left(\sum_{t=1}^{T_0}(y_{0t}-x_t \omega)^2+\lambda|\omega|_1  \right) \label{eq:lasso}
\end{align}\]</span></p>
<p>The lasso objective function consists of the same squared prediction error as OLS, but with an additional penalty that rises with the complexity of the vector of weights. In the expression, <span class="math inline">\(|\omega|_1\)</span> is the sum of the absolute values of the coefficients associated with each candidate control series. The penalty means that coefficients that are large in an unconstrained OLS regression shrink toward zero. Coefficients that are relatively small may shrink all the way to zero. Since some coefficients are set to zero, the lasso is able to estimate coefficients that minimize the penalized sum of squares even when the number of independent variables exceeds the number of observations. In addition, the regression framework relaxes the restriction that weights must be non-negative and sum to one. It is straightforward, for example, to add an intercept to the model by including a comparison unit that is simply equal to a constant in every period.</p>
<p>Our package uses the <code>glmnet</code> package in order to conduct lasso regressions. This is a very fast and flexible package with excellent documentation and a (free!) accompanying textbook, <a href="https://web.stanford.edu/~hastie/StatLearnSparsity/" class="external-link uri">https://web.stanford.edu/~hastie/StatLearnSparsity/</a>. By modifying the options of <code>glmnet</code> within our package a wide-variety of other models could be accommodated.</p>
<div id="how-to-choose-lambda" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-choose-lambda" class="anchor" aria-hidden="true"></a>How to choose <span class="math inline">\(\lambda\)</span>
</h2>
<p>A key choice parameter in the lasso regression method is the penalty parameter, which is represented by <span class="math inline">\(\lambda\)</span> in the above equation. As <span class="math inline">\(\lambda\)</span> increases, each weight in <span class="math inline">\(\widehat{\omega}_{lasso}\)</span> will attenuate and the set of donors with non-zero weight will become more sparse as many weights are driven to zero. At one extreme, the penalty parameter could be so large that every weight is set to zero. At the other extreme, the penalty parameter could be set to zero, which would simply be the OLS estimator.</p>
<p>We are going to see if there is a sparse weighted combination of the donor pool (i.e., x matrix) that creates a valid counter-factual prediction for our treated unit. We want to create the best possible out-of-sample prediction. It’s quite easy to generate a prediction that over-fits (or even perfectly fits the data in the pre-treatment time period), but this type over over-fitting will likely lead to poor out-of-sample predictions.</p>
<p>The weights are a function of the size of the penalty. The penalty induces sparsity. Every choice of <span class="math inline">\(\lambda\)</span> in between these extremes will result in a different set of unique weights. For each lasso regression, a number of <span class="math inline">\(\lambda\)</span> choices are considered in a grid from zero to the smallest value of <span class="math inline">\(\lambda\)</span>, which forces every weight to be zero.</p>
<p>Here we use all of the pre-treatment data to obtain weights for a number of lambda penalty values spaced upon a grid.</p>
<p><img src="scul-tutorial_files/figure-html/unnamed-chunk-9-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>You can see as the lambda changes, both the number of coefficients (i.e., weights) and the coefficients themselves change. Every line above displays the relationship between the log value of the penalty parameter the value of that coefficient. The bottom x-axis is the log penalty value, the y-axis is the value of the coefficients, the top x-axis is the number of coefficients with a non-zero value. Here we use all of the pre-treatment data to obtain weights for a number of lambda penalty values spaced upon a grid.</p>
<p>But how do these different number and value of coefficients affect the prediction we are interested in? We explore that next by using pre-treatment data to run four lasso regressions using only four different lambda values. We will then see how these four naive predictions do in the out-of-sample (i.e., post-treatment period)</p>
<p>The four <span class="math inline">\(\lambda\)</span> penalties that we will consider are:</p>
<ol style="list-style-type: decimal">
<li>
<p>one that removes all coefficients (i.e. there is only an intercept and it will be a straight line)</p>
<ul>
<li>
<span class="math inline">\(\lambda\)</span> = 9.4979772</li>
</ul>
</li>
<li>
<p>one that removes most of the coefficients</p>
<ul>
<li>
<span class="math inline">\(\lambda\)</span> = 6.2490348</li>
</ul>
</li>
<li>
<p>one that removes some coefficients</p>
<ul>
<li>
<span class="math inline">\(\lambda\)</span> = 3.924576</li>
</ul>
</li>
<li>
<p>one that removes no coefficients (lambda of zero)</p>
<ul>
<li>
<span class="math inline">\(\lambda\)</span> = 0</li>
<li>Note: In this last case if there are more donor variables than observations, the coefficients will not be identified (i.e., unique).</li>
</ul>
</li>
</ol>
<p><img src="scul-tutorial_files/figure-html/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>So how do we pick between these options? Should we pick the one that fits the line the best during the pre-treatment period? During the post-treatment period?</p>
<p>In general we want to pick the prediction that captures the underlying data generating process <em>before</em> treatment occurs, since we are using this prediction to evaluate a counterfactual as if treatment had not occurred. Treatment (if it has any effect) will impact the underlying data generating process.</p>
<div id="thoughtful-cross-validation-to-the-rescue" class="section level3">
<h3 class="hasAnchor">
<a href="#thoughtful-cross-validation-to-the-rescue" class="anchor" aria-hidden="true"></a>Thoughtful cross-validation to the rescue</h3>
<p>Cross-validation is a simple procedure where a dataset is partitioned into multiple subsets that include training data and test data; multiple analyses are performed on the training data; and the optimal analysis is determined using the test data. In our setting, lasso regressions across a grid of penalty parameters are performed for each subset of training data. The series of optimal weights is stored for each candidate penalty parameter. The test data are then used to evaluate which set of weights (i.e. which penalty parameter) produces the best out-of-sample prediction. Importantly, all data used in the cross-validation.</p>
<p>In short, cross-validation is an organized way of choosing between penalty parameters where the objective is to find weights that best match the underlying factors during the pre-treatment period <strong>and</strong> that will provide an acceptable out-of-sample prediction. It avoids overfitting. That is, it sets up a situation where we are more likely to find donors and weights that represent the underlying data generating process of interest and less likely to find donors and weights that match on noise.</p>
</div>
<div id="scul-uses-rolling-origin-cross-validation" class="section level3">
<h3 class="hasAnchor">
<a href="#scul-uses-rolling-origin-cross-validation" class="anchor" aria-hidden="true"></a>SCUL uses rolling-origin cross-validation</h3>
<p>Now we will set up our cross validation. We are going to do rolling forecasting origin cross validation. The main goal of the entire exercise (not just the cross-validation) is to predict the value of the treated variable for all of the post-treatment time periods, say <span class="math inline">\(T_{post}\)</span>. Thus we want to optimize our model for this type of prediction.</p>
<p>We do this because we do not want to use future observations to predict observations in the past. This can create a variety of issues related to autocorrelation, although there are some instances in which is doesn’t matter. If doing this on your own, you will need to be careful because the default cross-validation procedure used by many statistical procedures does not account for the fact that data may be time series and often uses “leave-one-out” cross-validation. See our working paper, <a href="https://robjhyndman.com/papers/cv-wp.pdf" class="external-link uri">https://robjhyndman.com/papers/cv-wp.pdf</a>, <span class="citation">Hyndman and Athanasopoulos (2020)</span>, or <span class="citation">Kellogg et al. (2020)</span> for more details.</p>
<p>In the procedure, we will only examine data from the pre-treatment period. We will also perform as many cross-validation runs as possible with the pre-treatment data being broken up into at least two, contiguous chunks. One chunk with consecutive time periods at least as long as <span class="math inline">\(T_{post}\)</span> and another chunk that follows immediately in time that is exactly as long as <span class="math inline">\(T_{post}\)</span>. We will increase the size of the first chunk by one time period for each cross-validation run and stop when we reach the maximum number of runs we can perform.</p>
<p>The figure below shows our cross-validation procedure visually. Here all of the data are pre-treatment. The square shapes indicate the training data, the circles indicate the test data, and the X’s indicate data that isn’t used in a particular cross-validation run. We will run one cross validation for each row you see below.</p>
<p><img src="scul-tutorial_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The SCUL procedure automatically chooses the penalty parameter using this procedure. The procedure preforms as many cross-validation runs as possible given the <code>PrePeriodLength</code> and the user input desired length of training (<code>NumberInitialTimePeriods</code>) and length of testing (<code>TrainingPostPeriodLength</code>).</p>
</div>
</div>
<div id="create-a-synthetic-control-group-using-the-scul-function" class="section level2">
<h2 class="hasAnchor">
<a href="#create-a-synthetic-control-group-using-the-scul-function" class="anchor" aria-hidden="true"></a>Create a synthetic control group using the <code>SCUL()</code> function</h2>
<p>Assuming you’ve set everything up correctly and have a list of elements named <code>SCUL.input</code>, you can simply run the <code><a href="../reference/SCUL.html">SCUL()</a></code> function to run the cross-validated procedure outlined above. We store the output as a list called <code>SCUL.output</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SCUL.output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SCUL.html">SCUL</a></span><span class="op">(</span><span class="va">plotCV</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><code>SCUL.output</code> contains a number of useful things.</p>
<ul>
<li>
<code>time</code>: A vector of the running time variable</li>
<li>
<code>TreatmentBeginsAt</code>: A scalar indicating the row that treatment begins</li>
<li>
<code>y.actual</code>: The observed target series</li>
<li>
<code>y.scul</code>: The counterfactul prediction from SCUL of the target series</li>
<li>
<code>CrossValidatedLambda</code>: The median cross-validated lambda from all of the cross-validation runs that is used to create <code>y.scul</code>. For this example, <span class="math inline">\(\lambda\)</span> = 0</li>
<li>
<code>CohensD</code>: A unit-free measure of fit between <code>y.actual</code> and <code>y.scul</code>. Discussed more below. For this example the fit is 0</li>
<li>
<code>coef.exact</code>: A matrix of the coefficients for each donor variable which are used to create the synthetic prediction. We present these in a slightly unconventional manner outlined later in the vignette.</li>
</ul>
</div>
<div id="plot-actual-data-and-scul-counterfactual-using-plotactualvscul" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-actual-data-and-scul-counterfactual-using-plotactualvscul" class="anchor" aria-hidden="true"></a>Plot actual data and SCUL counterfactual using <code>PlotActualvSCUL()</code>
</h2>
<p>Using the <code><a href="../reference/PlotActualvSCUL.html">PlotActualvSCUL()</a></code> function you can plot the observed data against the counterfactual prediction.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/PlotActualvSCUL.html">PlotActualvSCUL</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="scul-tutorial_files/figure-html/unnamed-chunk-13-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="evaluating-synthetic-control-fit" class="section level2">
<h2 class="hasAnchor">
<a href="#evaluating-synthetic-control-fit" class="anchor" aria-hidden="true"></a>Evaluating synthetic control fit</h2>
<p>There is no guarantee that the lasso regressions (or any other approach) can find a weighted mixture of donor units that closely mimics the treated unit during the pre-period. Therefore, researchers need a practical method of deciding whether a proposed synthetic control is “good enough” for proceeding with the analysis.</p>
<p>One rule of thumb is that a covariate is out of balance if the Cohen’s D statistic is greater than .25, which means that the imbalance between the groups is more than a quarter of a standard deviation for a particular variable <span class="citation">(Ho et al. 2007; King and Zeng 2006; Cochran 1968)</span>. The specific choice of a Cohen’s D threshold is arbitrary in most applications; in general, the smaller the discrepancy the better. However, the Cohen’s D statistic is a unit-free, standardized metric that is comparable across different variables.</p>
<p>We apply a modified version of the Cohen’s D to evaluate pre-period fit. Specifically, we let <span class="math inline">\(\sigma_{s} = \frac{1}{T_0}\sum_{t=1}^{T_0}(y_{st} - \overline{y_s})^2\)</span> be the standard deviation of outcome <span class="math inline">\(s\)</span> during the pre-treatment period. The pre-treatment average Cohen’s D statistic for a proposed synthetic control is <span class="math inline">\(D_s = \frac{1}{T_0}\sum_{t=1}^{T_0}|\frac{y_{st} - y^{*}_{st}}{\sigma_{s}}|\)</span>. We compute <span class="math inline">\(D_s\)</span> for each synthetic control candidate in our study. If <span class="math inline">\(D_s &gt; 0.25\)</span>, we do not report a synthetic control estimate for that outcome since the model could not provide a suitable fit. We apply the same standard to the placebo products we use to conduct statistical inference. We describe the consequences of different Cohen’s D inclusion thresholds for statistical power and inference more in our working paper.</p>
<p>In the table below, we report measures of pre-period fit and treatment effect estimates for five potential synthetic control estimators. Treatment effect estimates are simply the average difference between the actual and counterfactual SCUL prediction. The first prediction is from our SCUL procedure and uses a cross-validated penalty. The last four are the same naive lasso predictions we used earlier. The use the entire pre-treatment time-period and the penalties are therefore not cross-validated.</p>
<table class="table table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Method
</th>
<th style="text-align:right;">
Penalty parameter
</th>
<th style="text-align:right;">
Cohens D (pre-period fit)
</th>
<th style="text-align:right;">
ATE estimate
</th>
</tr></thead>
<tbody>
<tr grouplength="1">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>SCUL procedure using:</strong>
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; padding-left: 2em;" indentlevel="1">
Cross-validation for determining penalty
</td>
<td style="text-align:right;width: 2cm; ">
0.00
</td>
<td style="text-align:right;width: 2cm; ">
0.00
</td>
<td style="text-align:right;width: 2cm; ">
-15.05
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>SCUL using naive guesses for penalty</strong>
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; padding-left: 2em;" indentlevel="1">
Naive guess 1: Max penalty (remove all donors)
</td>
<td style="text-align:right;width: 2cm; ">
9.50
</td>
<td style="text-align:right;width: 2cm; ">
0.82
</td>
<td style="text-align:right;width: 2cm; ">
-50.34
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; padding-left: 2em;" indentlevel="1">
Naive guess 2: Random penalty
</td>
<td style="text-align:right;width: 2cm; ">
6.25
</td>
<td style="text-align:right;width: 2cm; ">
0.55
</td>
<td style="text-align:right;width: 2cm; ">
-35.70
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; padding-left: 2em;" indentlevel="1">
Naive guess 3: Random penalty
</td>
<td style="text-align:right;width: 2cm; ">
3.92
</td>
<td style="text-align:right;width: 2cm; ">
0.36
</td>
<td style="text-align:right;width: 2cm; ">
-26.97
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; padding-left: 2em;" indentlevel="1">
Naive guess 4: No penalty (include all donors)
</td>
<td style="text-align:right;width: 2cm; ">
0.00
</td>
<td style="text-align:right;width: 2cm; ">
0.00
</td>
<td style="text-align:right;width: 2cm; ">
-13.35
</td>
</tr>
</tbody>
</table>
</div>
<div id="reporting-synthetic-control-weights-i-e--determine-the-influence-of-each-regressor-in-the-prediction-using-plotsharetable" class="section level2">
<h2 class="hasAnchor">
<a href="#reporting-synthetic-control-weights-i-e--determine-the-influence-of-each-regressor-in-the-prediction-using-plotsharetable" class="anchor" aria-hidden="true"></a>Reporting synthetic control weights (i.e. determine the influence of each regressor in the prediction) using <code>PlotShareTable()</code>
</h2>
<p>Neither the traditional synthetic control weights nor the weights from the SCUL procedure can be directly interpreted as the share of the synthetic prediction composed by each donor series. Traditional synthetic control weights are constrained to sum to one across the donor units. Weights therefore only represent the fraction of the total weight that is given to a particular donor series; they do not reflect the size and variability of the outcome for each unit across time periods. The SCUL weights, which are lasso regression coefficients, are not constrained to sum to one and are not naturally interpreted as the share given to a particular donor series.</p>
<p>In both methods, the fraction of the synthetic prediction a given donor unit is responsible for changes with the value of the donor unit across time. Suppose, for example, that there are two donor series, A and B, observed in two periods, 1 and 2, and each unit receives a weight equal to <span class="math inline">\(\frac{1}{2}\)</span>. The donor values for the first time period are <span class="math inline">\(y_{A,1} = 10\)</span> and <span class="math inline">\(y_{B,1} = 1\)</span>. The donor values for the second time period are <span class="math inline">\(y_{A,2} = 1\)</span> and <span class="math inline">\(y_{B,2} = 10\)</span>. The resulting synthetic prediction is <span class="math inline">\(y_{1}^* = 5.5\)</span> in period 1 and <span class="math inline">\(y_{2}^* = 5.5\)</span> in period 2. In period 1, unit A represents <span class="math inline">\(100 \times \frac{ \frac{1}{2}\times 10}{5.5} = 91\%\)</span> of the synthetic prediction. In period 2, unit B represents <span class="math inline">\(91\%\)</span> of the synthetic prediction. Despite each donor weight being 50%, neither unit contributes 50% to the synthetic unit in either period.</p>
<p>Both the outcome and the weight share matter and since the outcome varies over time, the importance of each control unit may change over time as well. Below we use the <code><a href="../reference/PlotShareTable.html">PlotShareTable()</a></code> function to create a table that shows the relative contribution of each donor to the synthetic contribution. Shares are rounded to two decimal places. All donor variables not shown receive exactly zero weight.</p>
<table class="table table table-condensed">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Share for First Prediction
</th>
<th style="text-align:right;">
Share for Most Recent Prediction
</th>
<th style="text-align:right;">
Coefficient
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 97.58%">0.32</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 100.00%">0.33</span>
</td>
<td style="text-align:right;">
<span style="color: green">70.75</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_54
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 41.82%">0.09</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 41.82%">0.09</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.18</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_17
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 39.39%">0.08</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 34.55%">0.06</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.16</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_32
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 36.97%">0.07</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 32.12%">0.05</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.10</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_23
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 34.55%">0.06</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 32.12%">0.05</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.11</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
retprice_54
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 34.55%">0.06</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 39.39%">0.08</span>
</td>
<td style="text-align:right;">
<span style="color: red">-0.11</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_18
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 32.12%">0.05</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 32.12%">0.05</span>
</td>
<td style="text-align:right;">
<span style="color: red">-0.08</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_13
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 29.70%">0.04</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 29.70%">0.04</span>
</td>
<td style="text-align:right;">
<span style="color: red">-0.08</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
retprice_21
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 29.70%">0.04</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 34.55%">0.06</span>
</td>
<td style="text-align:right;">
<span style="color: red">-0.08</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_49
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 27.27%">0.03</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 27.27%">0.03</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.11</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_39
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 27.27%">0.03</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 24.85%">0.02</span>
</td>
<td style="text-align:right;">
<span style="color: red">-0.05</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_20
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 27.27%">0.03</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 24.85%">0.02</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.05</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_21
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 24.85%">0.02</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 27.27%">0.03</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.03</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_55
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 22.42%">0.01</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 22.42%">0.01</span>
</td>
<td style="text-align:right;">
<span style="color: red">-0.03</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_30
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 22.42%">0.01</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 22.42%">0.01</span>
</td>
<td style="text-align:right;">
<span style="color: red">-0.02</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
retprice_46
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 22.42%">0.01</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 22.42%">0.01</span>
</td>
<td style="text-align:right;">
<span style="color: red">-0.01</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_28
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 22.42%">0.01</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 22.42%">0.01</span>
</td>
<td style="text-align:right;">
<span style="color: red">-0.02</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_9
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 22.42%">0.01</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 22.42%">0.01</span>
</td>
<td style="text-align:right;">
<span style="color: red">-0.02</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_47
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 22.42%">0.01</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 22.42%">0.01</span>
</td>
<td style="text-align:right;">
<span style="color: red">-0.01</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
retprice_17
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 22.42%">0.01</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 22.42%">0.01</span>
</td>
<td style="text-align:right;">
<span style="color: red">-0.01</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_51
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.01</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
retprice_50
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 22.42%">0.01</span>
</td>
<td style="text-align:right;">
<span style="color: red">-0.01</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_45
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.01</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
retprice_8
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 22.42%">0.01</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.01</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_46
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.01</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
retprice_19
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: red">-0.01</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_42
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: black">0.00</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
retprice_1
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: black">0.00</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_27
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.01</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_8
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: black">0.00</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_16
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: black">0.00</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_56
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: black">0.00</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
retprice_18
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: black">0.00</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_37
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: black">0.00</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_40
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: black">0.00</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_31
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: black">0.00</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
cigsale_10
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: black">0.00</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
retprice_29
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: black">0.00</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
retprice_23
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: black">0.00</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
retprice_20
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: black">0.00</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
retprice_22
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: black">0.00</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
retprice_47
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: black">0.00</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
retprice_28
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: black">0.00</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
retprice_49
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.00</span>
</td>
<td style="text-align:right;">
<span style="color: black">0.00</span>
</td>
</tr>
</tbody>
</table>
<p>In this application, relative contributions appear to be stable across time. The single most important donor unit for California cigarette sales is the intercept, which is a measure of average pre-treatment cigarette sales in California. The second and third most influential donors are cigarettes sales in Illinois and Nevada.</p>
<p>Of note, cigarette sales in other states are all positively related, while prices in other states are all negatively related. We do not include California’s retail price of cigarette sales as a potential donor series as this would be endogenous. The negative relationship between out-of-state prices and in-state sales makes intuitive sense as increasing sales price may reflect trends that would also increase California prices or efforts to decrease demand for cigarettes.<br>
This negative contribution of a donor series is not possible in the traditional methods.</p>
</div>
<div id="statistical-inference" class="section level2">
<h2 class="hasAnchor">
<a href="#statistical-inference" class="anchor" aria-hidden="true"></a>Statistical Inference</h2>
<p>To perform statistical inference on our treatment estimates, we construct a rank-based, two-sided p-value using randomization inference <span class="citation">(Cavallo et al. 2013; Dube and Zipperer 2015)</span>. We compare the absolute value of the standardized treatment estimate to the absolute value of the standardized estimate from a number of placebo series. The estimates from the placebo distribution serve as the null distribution that assumes no treatment effect. In our setting, we use the same units compose both our donor pool and candidate placebo time series. In practice, however, the donor and placebo pools need not overlap. We limit the target time series considered, and placebo time series used for inference, to those that have synthetic control estimates that fit the data reasonably well during the pre-treatment period. We standardize using the pre-treatment period standard deviation for each respective time series, so that the respective treatment estimates are unit-free and comparable.</p>
<p>The first step in this procedure is to estimate a pseudo-treatment effect for each untreated unit in the placebo pool.</p>
<div id="run-scul-procedure-on-placebo-pool-to-estimate-pseudo-treatment-effects-using-createplacebodistribution" class="section level3">
<h3 class="hasAnchor">
<a href="#run-scul-procedure-on-placebo-pool-to-estimate-pseudo-treatment-effects-using-createplacebodistribution" class="anchor" aria-hidden="true"></a>Run SCUL procedure on placebo pool to estimate pseudo-treatment effects using <code>CreatePlaceboDistribution()</code>
</h3>
<p>If you’d like to specify any restrictions on the donor pool in each placebo run, you can do so by modifying the <code>DonorPoolRestrictionForEachPlacebo</code> argument.</p>
<p>To avoid including an endogenous donor variable, we don’t include the retail cigarette price in california <code>retprice_6</code> as a donor in the <code>SCUL</code> prediction for our target variable. For consistency we should apply a similar restriction for each donor pool for each placebo analysis.</p>
<p>This is simple to do because of the structure of our data. Recall that the digits following the <code>_</code> character in each variable name indicate the state FIPS. All we need to do is add a selection that removes any donor variables that have the same state FIPS as the target.</p>
<p>In our placebo analysis the target loops across every placebo and is indexed by <code>h</code>, so we first extract the relevant substring (last two characters) from the <code>h</code>th placebo unit. We then drop any varaibles that end with this substring.</p>
<p>This restriction will be passed to the donor pool using the <code>%&gt;%</code> feature so write it using <code>dplyr</code> language.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="va">drop_vars_from_same_FIPS</span> <span class="op">&lt;-</span>
 <span class="st">"select(-ends_with(substring(names(x.PlaceboPool)[h],nchar(names(x.PlaceboPool)[h]) - 2 + 1, nchar(names(x.PlaceboPool)[h]))))"</span></code></pre></div>
<p>Note: depending on the structure of your data, you can change this restriction. For example, if you used state abbreviations <em>at the begining</em> of each variable name rather than FIPS codes at the end. Then all you would need to do is to drop any variable that had the same first two characters. This could be done by writing the restriction as <code>"select(-starts_with(substring(names(x.PlaceboPool)[h],1, 2)))"</code></p>
<p>Now we can run the analysis for each placebo unit.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SCUL.inference</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CreatePlaceboDistribution.html">CreatePlaceboDistribution</a></span><span class="op">(</span>
  DonorPoolRestrictionForEachPlacebo <span class="op">=</span> <span class="va">drop_vars_from_same_FIPS</span>
<span class="op">)</span></code></pre></div>
<p>We save the output from this procedure as the list <code>SCUL.inference</code>. This list contains</p>
<ul>
<li>
<code>y.placebo.StandardizedDifference.Full</code>: the standardized difference between the actual and synthetic outcome for each placebo unit.</li>
<li>
<code>y.placebo.CohensD</code>: the Cohen’s D measure for pre-treatment fit for each placebo unit.</li>
</ul>
<p>Before we calculate the p-value we will visually examine the distribution across time and as an average in the post-period. We will then compare these distributions of pseudo-treatment effects to our estimated treatment effect.</p>
</div>
<div id="visually-compare-standardized-treatment-estimate-against-placebo-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#visually-compare-standardized-treatment-estimate-against-placebo-distribution" class="anchor" aria-hidden="true"></a>Visually compare standardized treatment estimate against placebo distribution</h3>
<div id="using-a-smoke-plot-and-the-smokeplot-function" class="section level4">
<h4 class="hasAnchor">
<a href="#using-a-smoke-plot-and-the-smokeplot-function" class="anchor" aria-hidden="true"></a>Using a smoke plot and the <code>SmokePlot()</code> function</h4>
<p>In the first figure, we compare the pseudo differences between each placebo and its synthetic control. The graph only includes placebo lines that survived the Cohen’s D screen by having a pre-treatment Cohen’s D less than 0.25. The placebo lines in the graph are drawn with some transparency so that the darker areas have a greater density of placebo units than lighter spaces. This shading highlights the deterioration of the counterfactual fit across time and gives the appearance of smoke. As such, we refer to this style of plot as a “smoke plot.” The difference between actual sales of cigarettes sold in California and the SCUL prediction is displayed in green. The pre-treatment difference is small and centered around zero.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">###############################################################################################</span>
<span class="co"># Make Smoke Plot</span>
<span class="va">smoke_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SmokePlot.html">SmokePlot</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">smoke_plot</span></code></pre></div>
<p><img src="scul-tutorial_files/figure-html/unnamed-chunk-19-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The spreading of the placebo distribution as time since treatment is the deterioration of model fit. Since the null distribution has the greatest power to detect small treatment effects when the distribution is less disperse, smaller treatment effects are more “detectable” closer to treatment time rather than farther away.</p>
</div>
<div id="using-a-density-plot-of-the-null-distribution-and-the-plotnulldistribution-function" class="section level4">
<h4 class="hasAnchor">
<a href="#using-a-density-plot-of-the-null-distribution-and-the-plotnulldistribution-function" class="anchor" aria-hidden="true"></a>Using a density plot of the null distribution and the <code>PlotNullDistribution()</code> function</h4>
<p>This second figure shows the distribution of average treatment effect (average difference between the actual placebo data and scul prediction) for the post-treatment time period. We show two distributions.</p>
<ul>
<li>One with no Cohen’s D restriction on the placebo pool</li>
<li>One with a 0.25 Cohen’s D restriction on the placebo pool</li>
</ul>
<p>In red on each figure is the “rejection region.” If an estimate falls in this region it is considered to be sufficiently rare so as to be statistically significant at the 10% level.</p>
<p>The <code><a href="../reference/PlotNullDistribution.html">PlotNullDistribution()</a></code> function takes a few inputs</p>
<ul>
<li>
<code>CohensD</code>: the Cohen’s D threshold used to trim the placebo distribution</li>
<li>
<code>StartTime</code> and <code>EndTime</code>: These form the beginning and end time periods over which the average pseudo treatment effect is calculated. This is useful if you want to consider smaller intervals of time than the entire post-treatment period.</li>
<li>
<code>width</code> and <code>height</code>: respective dimensions of the plot</li>
<li>
<code>AdjustmentParm</code> and <code>BandwidthParm</code>: parameters that affect the estimate of the density</li>
<li>various labels.</li>
</ul>
<p>We add to each density plot the treatment effect estimate (in standard deviation units). This is displayed by the red dashed-line.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Plot null distribution with no restriction on pre-period fit</span>
<span class="va">NullDist.Full</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PlotNullDistribution.html">PlotNullDistribution</a></span><span class="op">(</span>
    CohensD <span class="op">=</span> <span class="fl">999</span>,
    StartTime <span class="op">=</span> <span class="va">TreatmentBeginsAt</span>,
    EndTime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">SCUL.output</span><span class="op">$</span><span class="va">y.actual</span><span class="op">)</span>,
    height <span class="op">=</span> <span class="fl">2</span>,
    AdjustmentParm <span class="op">=</span> <span class="fl">1</span>,
    BandwidthParm <span class="op">=</span> <span class="fl">.25</span>,
    title_label <span class="op">=</span> <span class="st">"Placebo distribution compared\n to ATE estimate in\n pre-period standard deviations"</span>,
    y_label  <span class="op">=</span> <span class="st">" "</span>,
    x_label  <span class="op">=</span>  <span class="st">""</span>,
    subtitle_label  <span class="op">=</span>  <span class="st">"No Cohen's D restriction"</span>,
    rejection_label  <span class="op">=</span>  <span class="st">""</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_vline</span><span class="op">(</span>
        xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Results.y.StandardizedDiff</span><span class="op">[</span><span class="va">TreatmentBeginsAt</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Results.y.StandardizedDiff</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>,
        linetype <span class="op">=</span> <span class="st">"dashed"</span>,
        size <span class="op">=</span> <span class="fl">1</span>,
        color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>

<span class="co"># Plot null distribution 0.25 cohen's D restriction on pre-period fit</span>
<span class="va">NullDist.25</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PlotNullDistribution.html">PlotNullDistribution</a></span><span class="op">(</span>
    CohensD <span class="op">=</span> <span class="fl">0.25</span>,
    StartTime <span class="op">=</span> <span class="va">TreatmentBeginsAt</span>,
    EndTime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">SCUL.output</span><span class="op">$</span><span class="va">y.actual</span><span class="op">)</span>,
    height <span class="op">=</span> <span class="fl">2</span>,
    AdjustmentParm <span class="op">=</span> <span class="fl">1</span>,
    BandwidthParm <span class="op">=</span> <span class="fl">.25</span>,
    y_label  <span class="op">=</span> <span class="st">""</span>,
    x_label  <span class="op">=</span>  <span class="st">"Distribution of standardized difference\n for placebo donor pool"</span>,
    subtitle_label  <span class="op">=</span>  <span class="st">"0.25 Cohen's D restriction"</span>,
    rejection_label  <span class="op">=</span>  <span class="st">""</span>,
    title_label <span class="op">=</span> <span class="st">" "</span>,

<span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_vline</span><span class="op">(</span>
        xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Results.y.StandardizedDiff</span><span class="op">[</span><span class="va">TreatmentBeginsAt</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Results.y.StandardizedDiff</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>,
        linetype <span class="op">=</span> <span class="st">"dashed"</span>,
        size <span class="op">=</span> <span class="fl">1</span>,
        color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>

<span class="co"># Plot n</span>
<span class="co"># Combine the three plots</span>
<span class="va">combined_plot</span> <span class="op">&lt;-</span> <span class="fu">plot_grid</span><span class="op">(</span>
    <span class="va">NullDist.Full</span>,<span class="va">NullDist.25</span>,
    ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="co"># Display the plot</span>
<span class="va">combined_plot</span></code></pre></div>
<p><img src="scul-tutorial_files/figure-html/unnamed-chunk-20-1.png" width="50%" style="display: block; margin: auto;"></p>
<p>In general, a more compact null distribution is desirable because wider null distributions are less able to differentiate small treatment effects from statistical noise. Thus, synthetic control methods have the greatest power to detect small effect sizes in the time periods closest to treatment, and when the synthetic control method also provides a satisfactory fit for the placebo pool used to compose the null distribution.</p>
<p>Maximizing statistical power in these ways is not without trade-offs. Dynamic treatment effects that grow over time may not be large enough to be detectable in the periods immediately following treatment. Using a smaller Cohen’s D threshold can improve power by eliminating noisy placebo units, but this also may eliminate target units that do not meet the pre-treatment fit quality standard.</p>
</div>
<div id="use-pvalue-to-determine-permutation-based-two-sided-p-value" class="section level4">
<h4 class="hasAnchor">
<a href="#use-pvalue-to-determine-permutation-based-two-sided-p-value" class="anchor" aria-hidden="true"></a>Use <code>PValue()</code> to determine permutation based two-sided p-value</h4>
<p>We construct a two-sided p-value by comparing the rank of the absolute value of the standardized treatment effect for the target series against the absolute value of the estimated standardized pseudo-treatment effect for each untreated unit. The p-value is simply the percentile of the rank. For smaller placebo pools, it may make sense to report a bounded p-value. For example, if there are one treated unit and 49 placebos, then a rank of 2 out of 50 represents a p-value of between .02 and .04</p>
<p>The <code><a href="../reference/PValue.html">PValue()</a></code> function takes a few inputs</p>
<ul>
<li>
<code>CohensD</code>: the Cohen’s D threshold used to trim the placebo distribution</li>
<li>
<code>StartTime</code> and <code>EndTime</code>: These form the beginning and end time periods over which the average pseudo treatment effect is calculated. This is useful if you want to consider smaller intervals of time than the entire post-treatment period.</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#########################################################################################################</span>
<span class="co"># Calculate an average post-treatment p-value</span>
<span class="fu"><a href="../reference/PValue.html">PValue</a></span><span class="op">(</span>
    CohensD <span class="op">=</span> <span class="fl">999</span>,
    StartTime <span class="op">=</span> <span class="va">SCUL.input</span><span class="op">$</span><span class="va">TreatmentBeginsAt</span>,
    EndTime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Results.y.StandardizedDiff</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt;   p.value.high</span>
<span class="co">#&gt; 1         0.21</span>

<span class="fu"><a href="../reference/PValue.html">PValue</a></span><span class="op">(</span>
    CohensD <span class="op">=</span> <span class="fl">.25</span>,
    StartTime <span class="op">=</span> <span class="va">SCUL.input</span><span class="op">$</span><span class="va">TreatmentBeginsAt</span>,
    EndTime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Results.y.StandardizedDiff</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt;   p.value.high</span>
<span class="co">#&gt; 1         0.04</span></code></pre></div>
<p>As could also be seen in the first density plot, when we allow all units in the placebo pool (i.e., no Cohen’s D restriction) to contribute to the null distribution estimate, our treatment effect estimate does not appear sufficiently rare. It has a p-value of 0.4. However, when we include only those placebos where the SCUL procedure found a suitable counterfactual (judged by Cohen’s D less than or equal to 0.25), our treatment effect estimate is extremely rare with a p-value of 0.02.</p>
</div>
</div>
</div>
</div>
<div id="comparison-with-traditional-synthetic-control-method" class="section level1">
<h1 class="hasAnchor">
<a href="#comparison-with-traditional-synthetic-control-method" class="anchor" aria-hidden="true"></a>Comparison with traditional synthetic control method</h1>
<p>To compose the counterfactual estimate, <span class="math inline">\(\widehat{y(0)}_{st}\)</span>, typical synthetic control methods use a convex weighted average of the same target variable from the untreated units. The set of target variables here is also referred to as the donor pool.</p>
<p>In the traditional method, each donor receives a single weight, which must be non-negative and between zero and one. The weights for all untreated donor units must sum to one. These restriction combine to create a check against extrapolation from the donor pool. Specifically, no synthetic control estimate can be greater than the largest value of the donor pool. We explore the consequences of these restrictions in more detail in our paper.</p>
<p>The set of weights across all donor units are chosen such that they minimize an importance weighted combination of</p>
<ol style="list-style-type: decimal">
<li>the distance between pre-treatment synthetic predictions and actual pre-treatment data</li>
<li>and the difference between a set of predicted and actual <em>summary statistics</em> chosen by the researcher. - the <em>summary statistics</em> as we call them here can refer to any number of things that the researcher would normally consider in a balance table. There could be a great number of them; (a particular value of the target variable in the pre-period, four values of another important variable from different pre-period years, the standard deviation of yet another variable).</li>
</ol>
<p>The importance weights for each <em>summary statistic</em> in (2) and for the cumulative donor weights (1) are determined in an iterative procedure. The nature of this procedure limits the combined number of potential donor units (and the number user-chosen summary statistics) to be less than the number of observations for the treated unit.</p>
<p>A full review of the traditional method is beyond the scope of this vignette. <span class="citation">Abadie, Diamond, and Hainmueller (2010)</span> developed the original and mostly widely used method of constructing a synthetic control group and <span class="citation">Alberto Abadie (2020)</span> provide an excellent overview of the traditional synthetic control method as well as other recent extensions.</p>
<p>However, we have constructed our data in such a way that we can conduct a version of the traditional approach. Here the <em>summary statistics</em> will be</p>
<ul>
<li>mean retail price</li>
<li>mean cigarette sales in 1970</li>
<li>mean cigarette sales in 1980</li>
<li>mean cigarette sales in 1985</li>
</ul>
<p>We implement the procedure using the <code>Synth</code> package.</p>
<p>The first figure shows two time series, each a difference between actual cigarette sales and a synthetic prediction.</p>
<ul>
<li>The green solid line is the difference using the SCUL prediction</li>
<li>The orange dashed line is the difference using the traditional prediction</li>
</ul>
<p>Both have very similar properties. Small deviations during the pre-period and large negative deviations in the post-treatment period.</p>
<p><img src="scul-tutorial_files/figure-html/unnamed-chunk-23-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The table below displays the average treatment effect across the two models. They are very similar, 13.5 for SCUL and 14.9 for the traditional method. The table also displays the measure of pre-period fit. Despite using a cross-validation procedure the SCUL estimate produces a better pre-period fit by an order of magnitude (0.015 vs. 0.155).</p>
<table class="table table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Method
</th>
<th style="text-align:left;">
Penalty parameter
</th>
<th style="text-align:right;">
Cohens D (pre-period fit)
</th>
<th style="text-align:right;">
ATE estimate
</th>
</tr></thead>
<tbody>
<tr grouplength="1">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>SCUL procedure using:</strong>
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; padding-left: 2em;" indentlevel="1">
Cross-validation for determining penalty
</td>
<td style="text-align:left;width: 2cm; ">
0
</td>
<td style="text-align:right;width: 2cm; ">
0.002
</td>
<td style="text-align:right;width: 2cm; ">
-15.053
</td>
</tr>
<tr grouplength="1">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Traditional SCM method</strong>
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;width: 2cm; ">
NA
</td>
<td style="text-align:right;width: 2cm; ">
0.155
</td>
<td style="text-align:right;width: 2cm; ">
-14.933
</td>
</tr>
</tbody>
</table>
<p>We also display the traditional weights as well as the share each donor contributes to the first and last prediction (our preferred way of displaying weights). All donors here are only cigarette sales in other states. The number in the first column is the FIPS code for each donor.</p>
<p>Unlike the weights for SCUL (displayed earlier), the weights for the traditional method are all positive and sum to one. However these weights are not the same as the share the variable contributes to the prediction. Take the first donor (Kentucky) for example. The coefficient on Kentucky cigarette sales is 0.3229, but in the most recent prediction the share this donor is responsible for is 52.11%.</p>
<p>Also of note. Many of these variable receive nearly, but not exactly zero weight. The SCUL procedure produces a more sparse set of donors since the majority of the donors receive <em>exactly</em> zero weight.</p>
<table class="table table table-condensed">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Share for First Prediction
</th>
<th style="text-align:right;">
Share for Most Recent Prediction
</th>
<th style="text-align:right;">
Coefficient
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
21
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 100.00%">0.4848</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 88.62%">0.4159</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.3229</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
34
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 53.44%">0.2028</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 64.15%">0.2677</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.3486</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
23
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 46.07%">0.1582</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 46.40%">0.1602</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.1925</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 35.31%">0.0930</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 34.12%">0.0858</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0839</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
37
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.41%">0.0028</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.56%">0.0037</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0024</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
19
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.35%">0.0024</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.48%">0.0032</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0026</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
38
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.33%">0.0023</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.40%">0.0027</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0021</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.33%">0.0023</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.36%">0.0025</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0023</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.31%">0.0022</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.38%">0.0026</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0020</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
24
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.30%">0.0021</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.33%">0.0023</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0014</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
20
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.30%">0.0021</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.36%">0.0025</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0021</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.30%">0.0021</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.30%">0.0021</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0016</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.28%">0.0020</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.26%">0.0019</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0018</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.28%">0.0020</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.38%">0.0026</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0014</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
36
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.26%">0.0019</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.30%">0.0021</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0014</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
18
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.26%">0.0019</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.33%">0.0023</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0014</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.26%">0.0019</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.30%">0.0021</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0018</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.26%">0.0019</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.31%">0.0022</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0021</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
26
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.26%">0.0019</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.30%">0.0021</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0014</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
29
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.26%">0.0019</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.20%">0.0015</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0013</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
30
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.26%">0.0019</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.35%">0.0024</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0014</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
28
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.25%">0.0018</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.28%">0.0020</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0016</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
39
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.25%">0.0018</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.30%">0.0021</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0015</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.23%">0.0017</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.28%">0.0020</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0012</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.23%">0.0017</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.23%">0.0017</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0013</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.23%">0.0017</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.28%">0.0020</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0014</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
31
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.23%">0.0017</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.30%">0.0021</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0017</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
17
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.23%">0.0017</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.30%">0.0021</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0014</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.21%">0.0016</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.28%">0.0020</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0014</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
16
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.21%">0.0016</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.25%">0.0018</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0016</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
32
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.21%">0.0016</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.26%">0.0019</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0012</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.21%">0.0016</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.25%">0.0018</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0012</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
33
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.21%">0.0016</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.20%">0.0015</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0015</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
27
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.20%">0.0015</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.28%">0.0020</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0014</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
35
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.18%">0.0014</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.18%">0.0014</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0010</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.17%">0.0013</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.26%">0.0019</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0007</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
25
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.10%">0.0009</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.13%">0.0011</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0010</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
22
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.00%">0.0003</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: #3399FF; width: 20.02%">0.0004</span>
</td>
<td style="text-align:right;">
<span style="color: green">0.0002</span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="when-would-you-want-non-convex-or-negative-weights" class="section level1">
<h1 class="hasAnchor">
<a href="#when-would-you-want-non-convex-or-negative-weights" class="anchor" aria-hidden="true"></a>When would you want non-convex or negative weights?</h1>
<p>The traditional synthetic control method restricts weights to be non-negative and to sum to one. These restrictions force the synthetic control group to remain within the support (i.e., convex hull) of the donor pool, preventing extrapolation. This can certainly be a desirable property. However there are some situations where these restrictions that prevent extrapolation can inhibit a synthetic control group from finding a perfect donor series.</p>
<ul>
<li>Case 1: When the target series is outside the the support of the donor pool (i.e. you need extrapolation to match the target series</li>
<li>Case 2: When negatively correlated donors can help identify underlying data generating process (e.g., two financial assets, or a price and consumption series)</li>
</ul>
<p><img src="scul-tutorial_files/figure-html/unnamed-chunk-27-1.png" width="100%" style="display: block; margin: auto;"> The SCUL procedure is a flexible synthetic control method that accommodates both of these scenarios. It also allows for more donors than time periods (i.e., high-dimensional data), which is not possible using the traditional method.</p>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor" aria-hidden="true"></a>Session-info</h1>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; R version 4.0.3 (2020-10-10)</span>
<span class="co">#&gt; Platform: x86_64-apple-darwin17.0 (64-bit)</span>
<span class="co">#&gt; Running under: macOS Big Sur 10.16</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib</span>
<span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt;  [1] Synth_1.1-5         formattable_0.2.0.1 cowplot_1.1.0      </span>
<span class="co">#&gt;  [4] kableExtra_1.3.4    knitr_1.33          pBrackets_1.0      </span>
<span class="co">#&gt;  [7] glmnet_4.0-2        Matrix_1.2-18       forcats_0.5.0      </span>
<span class="co">#&gt; [10] stringr_1.4.0       dplyr_1.0.2         purrr_0.3.4        </span>
<span class="co">#&gt; [13] readr_1.4.0         tidyr_1.1.2         tibble_3.1.2       </span>
<span class="co">#&gt; [16] ggplot2_3.3.2       tidyverse_1.3.0     scul_0.2.0.0       </span>
<span class="co">#&gt; [19] pacman_0.5.1       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] colorspace_2.0-0     ellipsis_0.3.2       class_7.3-17        </span>
<span class="co">#&gt;  [4] rprojroot_2.0.2      fs_1.5.0             rstudioapi_0.13     </span>
<span class="co">#&gt;  [7] farver_2.0.3         ggrepel_0.9.0        prodlim_2019.11.13  </span>
<span class="co">#&gt; [10] fansi_0.4.2          lubridate_1.7.9.2    xml2_1.3.2          </span>
<span class="co">#&gt; [13] codetools_0.2-16     splines_4.0.3        cachem_1.0.5        </span>
<span class="co">#&gt; [16] jsonlite_1.7.2       pROC_1.16.2          caret_6.0-86        </span>
<span class="co">#&gt; [19] broom_0.7.2          kernlab_0.9-29       dbplyr_2.0.0        </span>
<span class="co">#&gt; [22] compiler_4.0.3       httr_1.4.2           backports_1.2.0     </span>
<span class="co">#&gt; [25] assertthat_0.2.1     fastmap_1.1.0        cli_2.5.0           </span>
<span class="co">#&gt; [28] htmltools_0.5.1.1    tools_4.0.3          gtable_0.3.0        </span>
<span class="co">#&gt; [31] glue_1.4.2           reshape2_1.4.4       Rcpp_1.0.5          </span>
<span class="co">#&gt; [34] cellranger_1.1.0     jquerylib_0.1.4      pkgdown_1.6.1.9001  </span>
<span class="co">#&gt; [37] vctrs_0.3.8          svglite_2.0.0        nlme_3.1-149        </span>
<span class="co">#&gt; [40] iterators_1.0.13     timeDate_3043.102    gower_0.2.2         </span>
<span class="co">#&gt; [43] xfun_0.23            rvest_0.3.6          lifecycle_1.0.0     </span>
<span class="co">#&gt; [46] MASS_7.3-53          scales_1.1.1         ipred_0.9-9         </span>
<span class="co">#&gt; [49] ragg_1.1.2           hms_0.5.3            yaml_2.2.1          </span>
<span class="co">#&gt; [52] memoise_2.0.0        sass_0.4.0           rpart_4.1-15        </span>
<span class="co">#&gt; [55] stringi_1.6.2        highr_0.9            desc_1.3.0          </span>
<span class="co">#&gt; [58] foreach_1.5.1        optimx_2020-4.2      lava_1.6.8.1        </span>
<span class="co">#&gt; [61] shape_1.4.5          rlang_0.4.11         pkgconfig_2.0.3     </span>
<span class="co">#&gt; [64] systemfonts_1.0.2    evaluate_0.14        lattice_0.20-41     </span>
<span class="co">#&gt; [67] recipes_0.1.15       htmlwidgets_1.5.2    labeling_0.4.2      </span>
<span class="co">#&gt; [70] tidyselect_1.1.0     plyr_1.8.6           magrittr_2.0.1      </span>
<span class="co">#&gt; [73] R6_2.5.0             generics_0.1.0       DBI_1.1.0           </span>
<span class="co">#&gt; [76] pillar_1.6.1         haven_2.3.1          withr_2.4.2         </span>
<span class="co">#&gt; [79] survival_3.2-7       nnet_7.3-14          modelr_0.1.8        </span>
<span class="co">#&gt; [82] crayon_1.4.1         utf8_1.2.1           rmarkdown_2.8       </span>
<span class="co">#&gt; [85] grid_4.0.3           readxl_1.3.1         data.table_1.13.2   </span>
<span class="co">#&gt; [88] ModelMetrics_1.2.2.2 reprex_0.3.0         digest_0.6.27       </span>
<span class="co">#&gt; [91] webshot_0.5.2        numDeriv_2016.8-1.1  textshaping_0.3.4   </span>
<span class="co">#&gt; [94] stats4_4.0.3         munsell_0.5.0        viridisLite_0.3.0   </span>
<span class="co">#&gt; [97] bslib_0.2.5.1</span></code></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor" aria-hidden="true"></a>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Abadie2010" class="csl-entry">
Abadie, Alberto, Alexis Diamond, and Jens Hainmueller. 2010. <span>“<span class="nocase">Synthetic Control Methods for Comparative Case Studies: Estimating the Effect of California’s Tobacco Control Program</span>.”</span> <em>Journal of the American Statistical Association</em> 105 (490): 493–505. <a href="https://doi.org/10.1198/jasa.2009.ap08746" class="external-link">https://doi.org/10.1198/jasa.2009.ap08746</a>.
</div>
<div id="ref-AlbertoAbadie2020" class="csl-entry">
Alberto Abadie. 2020. <span>“<span class="nocase">Using Synthetic Controls: Feasibility, Data Requirements, and Methodological Aspects</span>.”</span> <em>Journal of Economic Literature</em> Forthcoming.
</div>
<div id="ref-Cavallo2013" class="csl-entry">
Cavallo, Eduardo, Sebastian Galiani, Ilan Noy, and Juan Pantano. 2013. <span>“<span class="nocase">Catastrophic Natural Disasters and Economic Growth</span>.”</span> <em>Review of Economics and Statistics</em> 95 (5): 1549–61. <a href="https://doi.org/10.1162/REST_a_00413" class="external-link">https://doi.org/10.1162/REST_a_00413</a>.
</div>
<div id="ref-Cochran1968" class="csl-entry">
Cochran, W. G. 1968. <span>“<span class="nocase">The Effectiveness of Adjustment by Subclassification in Removing Bias in Observational Studies</span>.”</span> <em>Biometrics</em> 24 (2): 295. <a href="https://doi.org/10.2307/2528036" class="external-link">https://doi.org/10.2307/2528036</a>.
</div>
<div id="ref-Dube2015" class="csl-entry">
Dube, Arindrajit, and Ben Zipperer. 2015. <span>“<span class="nocase">Pooling Multiple Case Studies Using Synthetic Controls: An Application to Minimum Wage Policies</span>.”</span> <em>IZA Discussion Paper No. 8944</em>.
</div>
<div id="ref-Ho2007" class="csl-entry">
Ho, Daniel E., Kosuke Imai, Gary King, and Elizabeth A. Stuart. 2007. <span>“<span class="nocase">Matching as Nonparametric Preprocessing for Reducing Model Dependence in Parametric Causal Inference</span>.”</span> <em>Political Analysis</em> 15 (3): 199–236. <a href="https://doi.org/10.1093/pan/mpl013" class="external-link">https://doi.org/10.1093/pan/mpl013</a>.
</div>
<div id="ref-Hyndman2020" class="csl-entry">
Hyndman, Rob J, and George Athanasopoulos. 2020. <em><span class="nocase">Forecasting: principles and practice</span></em>. 2nd ed. Melbourne, Australia: OTexts. <a href="https://OTexts.com/fpp2" class="external-link">OTexts.com/fpp2</a>.
</div>
<div id="ref-Kellogg2020" class="csl-entry">
Kellogg, Maxwell, Magne Mogstad, Guillaume Pouliot, and Alexander Torgovitsky. 2020. <span>“<span class="nocase">Combining Matching and Synthetic Controls to Trade off Biases from Extrapolation and Interpolation</span>.”</span> <em>National Bureau of Economic Research</em>. <a href="https://doi.org/10.3386/w26624" class="external-link">https://doi.org/10.3386/w26624</a>.
</div>
<div id="ref-King2006" class="csl-entry">
King, Gary, and Langche Zeng. 2006. <span>“<span class="nocase">The Dangers of Extreme Counterfactuals</span>.”</span> <em>Political Analysis</em> 14 (2): 131–59. <a href="https://doi.org/10.1093/pan/mpj004" class="external-link">https://doi.org/10.1093/pan/mpj004</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://alexjhollingsworth.com" class="external-link external-link">Alex Hollingsworth</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
